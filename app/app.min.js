(function() { var debugMode = false; 
/*!
 * Betrue 2017 .
 * http://alizarion.github.io/betrued
 *
 * Betrue, v1.0.0
 * Apache 2.0 license.*/
angular.module("betrue.ar",["ngMaterial","angular-spinkit"]),angular.module("betrue.ar").controller("MainController",["$scope","$mdDialog",function(e,n){var t=this;if(t.modernizr=Modernizr,e.progression=0,t.modernizr.webgl&&t.modernizr.webglextensions&&t.modernizr.getusermedia&&t.modernizr.peerconnection){var o=new THREE.ColladaLoader;o.load("assets/3d/Robo8.dae",function(e){function n(){c.onResize(),c.copySizeTo(r.domElement),null!==p.arController&&c.copySizeTo(p.arController.canvas)}var t,o=e.animations,a=e.scene;t=new THREE.AnimationMixer(a);t.clipAction(o[0]).play();a.scale.x=a.scale.y=a.scale.z=.2;var r=new THREE.WebGLRenderer({alpha:!0});clock=new THREE.Clock,r.setClearColor(new THREE.Color("lightgrey"),0),r.setSize(window.innerWidth,window.innerHeight),r.domElement.style.position="absolute",r.domElement.style.top="0px",r.domElement.style.left="0px";var i=new Audio("assets/mp3/song52.mp3");setTimeout(function(){i.pause()},3e3);var l=[],d=new THREE.Scene,s=new THREE.Camera;d.add(s);var c=new THREEx.ArToolkitSource({sourceType:"webcam"});c.init(function(){n()}),window.addEventListener("resize",function(){n()});var p=new THREEx.ArToolkitContext({cameraParametersUrl:THREEx.ArToolkitContext.baseURL+"../data/data/camera_para.dat",detectionMode:"mono",maxDetectionRate:30,canvasWidth:240,canvasHeight:180});p.init(function(){s.projectionMatrix.copy(p.getProjectionMatrix())}),l.push(function(){c.ready!==!1&&p.update(c.domElement)});var u=new THREE.Group;d.add(u);var m=(new THREEx.ArMarkerControls(p,u,{type:"pattern",patternUrl:THREEx.ArToolkitContext.baseURL+"../data/data/patt.hiro"}),new THREE.Group);d.add(m);var E=new THREEx.ArSmoothedControls(m,{lerpPosition:.4,lerpQuaternion:.3,lerpScale:1});l.push(function(e){E.update(u)});var w=m,T=new THREE.AmbientLight(16777215,.2);w.add(T);var v=new THREE.DirectionalLight(16777215,.8);v.target=a,w.add(v),w.add(a),l.push(function(){r.render(d,s);var e=clock.getDelta();u.visible||i.pause(),u.visible&&i.play(),void 0!==t&&t.update(e)});var R=null;requestAnimationFrame(function g(e){requestAnimationFrame(g),R=R||e-1e3/60;var n=Math.min(200,e-R);R=e,l.forEach(function(t){t(n/1e3,e/1e3)})}),document.body.appendChild(r.domElement)},function(n){e.$applyAsync(function(){e.progression=Math.floor(100*n.loaded/n.total)})})}else n.show(n.alert().parent(angular.element(document.querySelector("#popupContainer"))).clickOutsideToClose(!0).title("Oups ..").textContent("Votre navigateur n'est pas compatible avec cette animation, une application mobile sera bientot disponible").ok("Ok :("))}]);
})();